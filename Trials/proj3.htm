<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.4.2.js">
    </script>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>proj3.htm</title>
        <!--CSS Style Sheet-->
        <style type="text/css">
            p.test {
                color: #FF00FF;
            }
            
            p.test2 {
                color: #000000;
            }
            
            div.frame {
                color: #FF00FF;
            }
			
			
        </style>
        <script type="text/javascript">
            patchSize = 256;
            zoomlevel = 0;
            imageSize = Math.pow(2, zoomlevel) * patchSize;
            
            //test of pink coloring of text
            //$(document).ready(function(){
            //$("p").addClass("test");
            //$("div").addClass("frame");
            //setTimeout("$("p").removeClass("test1")",1900);
            //$("div:last").hide("slow");
            
            //setTimeout("$(\"div:last\").hide(\"slow\")",2000);
            //blank setTimeout function
            //setTimeout("",2000);
            
            //this applies a style attribute after a delay
            //setTimeout("$(\"p\").addClass(\"test2\")", 1000);
            
            
            function change(){
                //the following is the jQuery code
                //the $ is just by convention
                var height = $('#text1').attr('value');
                var width = $('#text2').attr('value');
                var left = 0;
                var top = 0;
                $('#VW').css("height", height + 'px');
                $('#VW').css("width", width + 'px');
                zoomlevel = $('#text3').attr('value') + 'px';
                $('#patchGrid').css("clip", function(){
                    return 'rect(' + top + 'px, ' + width + 'px, ' + height + 'px, ' + left + 'px)'
                });
                //or you can do this:
                //var $clip = 'rect(' + top + 'px, ' + width + 'px, ' + height + 'px, ' + left + 'px)'
                //$('#patchGrid').css("clip", function(){
                //return $clip
                //});
            
            
                //var height = document.getElementById("text1").value;
                //var width = document.getElementById("text2").value;
                //var left = 0;
                //var top = 0;
                //document.getElementById("VW").style.height = document.getElementById("text1").value + "px";
                //document.getElementById("VW").style.width = document.getElementById("text2").value + "px";  
                //zoomlevel = document.getElementById("text3").value + "px";
                //document.getElementById("patchGrid").style.clip = "rect(" + top + "px " + width + "px " + height + "px " + left + "px)";
            
            }
            
            function gridFormation(){
                i = document.createElement("img");
                i.id = "img1";
                i.height = patchSize;
                i.width = patchSize;
                document.getElementById("patchGrid").appendChild(i);
            }
            
            function LoadPatch(){
                zoomlevel = $('#text3').attr("value");
                
                LoadImage();
                //$('#img1').attr('src', function(){
                //return 'http://wonko.via.cornell.edu/bigimgs/test1/foo.' + zoomlevel + '.0.0.0.jpeg'
                //});
            
                //zoomlevel = document.getElementById("text3").value;
                //document.getElementById("img1").src = "http://wonko.via.cornell.edu/bigimgs/test1/foo." + zoomlevel + ".0.0.0.jpeg";
            }
            
            function LoadImage(){
                // when the DOM is ready
                //alert("yello!");
                var img = new Image();
                
                // wrap our new image in jQuery, then:
                $(img).load(function(){// once the image has loaded, execute this code
                    // set the image hidden by default    
                    $(img).hide();
                    
                    // with the holding div #loader, apply:
                    //$('#loader').removeClass('loading') // remove the loading class (so no background spinner), 
                    // then insert our image
                    $('#patchGrid').empty().append(img);
                    
                    // fade our image in to create a nice effect
                    //$(img).show();
                    $(img).fadeIn();
                    
                }) // if there was an error loading the image, react accordingly
            .error(function(){
                    alert(zoomlevel);// notify the user that the image could not be loaded
                }) //.attr('src','http://www.ajaxload.info/cache/FF/FF/FF/00/00/00/19-0.gif')
                //delaying this step so that we can see the loading image
                
                //.delay(3000) // *finally*, set the src attribute of the new image to our image      
                //.attr('src', 'http://www.sanbaldo.com/wordpress/wp-content/bigrotation2.gif')
                .attr('src', function(){
                    return 'http://wonko.via.cornell.edu/bigimgs/test1/foo.' + zoomlevel + '.0.0.0.jpeg';
                });
                
                
                //$("#container").empty().image("http://www.sanbaldo.com/wordpress/wp-content/bigrotation2.gif", function(){
                    //alert("Image OK !");
                //});
                //document ready ends here
            }
            
            $.fn.image = function(src, f){
                return this.each(function(){
                    $("<img />").appendTo(this).each(function(){
                        this.src = src;
                        this.onload = f;
                    });
                });
            }
        </script>
    </head>
    <body onload="change();gridFormation();LoadPatch()">
        <table border="2">
            <tr>
                <td>
                    <label for="text1" class="hiddenlabel">
                        Height:
                    </label>
                    <br/>
                    <input id="text1" name="Height" type="text" value="300" onkeypress="if(event.keyCode == 13 || event.keyCode == 9) change()"/>
                </td>
                <td>
                    <label for="text2" class="hiddenlabel">
                        Width:
                    </label>
                    <br/>
                    <input id="text2" name="Width" type="text" value="300" onkeypress="if(event.keyCode == 13 || event.keyCode == 9) {change();gridFormation()}"/>
                </td>
                <td>
                    <label for="text3" class="hiddenlabel">
                        Zoomlevel:
                    </label>
                    <br/>
                    <input id="text3" name="Zoomlevel" type="text" value="0" onkeypress="if(event.keyCode == 13 || event.keyCode == 9) LoadPatch()"/>
                </td>
            </tr>
        </table>
        <p>
            <b>proj3.htm</b>
            - please press the enter key after typing number in text box.
        </p>
        <ul>
            <li>
                load f.0.0.0.jpeg from http://wonko.via.cornell.edu/bigimgs/test1/
            </li>
            <li>
                when x-size or y-size are < 256 then the viewing window clips the image
            </li>
            <li>
                Enter a number into zoom and the “zoomed” image is loaded
            </li>
        </ul>
        <!--The actual image inside the viewing window-->
        <div id="patchGrid" style="border: thin #000000 none; position: absolute; width: 512px; height: 512px; z-index: 1; left: 200px; top: 200px">
        </div>
        <!--The outside pink border-->
        <div id="VW" style="border: thin #FF00FF solid; position: absolute; width: 50px; height: 50px; z-index: 1; left: 200px; top: 200px">
        </div>
        <!--<div id="container">
            <img src="http://wonko.via.cornell.edu/bigimgs/test1/foo.0.0.0.0.jpeg"/>
        </div>-->
    </body>
</html>